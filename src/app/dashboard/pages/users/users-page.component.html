<section>
  <div class="flex flex-col gap-4 md:flex-row">
    <div class="flex-auto">
      <h2 class="heading">Users</h2>
      <p class="mt-1 text-sm">
        A list of all the users registered including their name, email, and
        role.
      </p>
    </div>
  </div>

  <div class="mt-8">
    <input
      appInput
      type="text"
      name="search"
      placeholder="Filter users..."
      autocomplete="off"
      [(ngModel)]="search"
      (keydown.enter)="searchUser()"
      class="max-w-72"
    />
    <button appButton variant="secondary" (click)="clearSearch()" class="ml-4">
      Clear filters
    </button>
  </div>

  <div class="mt-4 overflow-auto rounded-md border shadow-sm">
    <table class="table w-full min-w-max table-auto divide-y divide-zinc-200">
      <thead class="bg-zinc-50">
        @for (headerGroup of table.getHeaderGroups(); track headerGroup.id) {
          <tr>
            @for (header of headerGroup.headers; track header.id) {
              @if (!header.isPlaceholder) {
                <th
                  scope="col"
                  class="px-4 py-2 text-start text-sm font-medium capitalize tracking-tight"
                >
                  <ng-container
                    *flexRender="
                      header.column.columnDef.header;
                      props: header.getContext();
                      let header
                    "
                  >
                    <div [innerHTML]="header"></div>
                  </ng-container>
                </th>
              }
            }
          </tr>
        }
      </thead>
      <tbody class="divide-y divide-zinc-200">
        @if (table.getRowCount() > 0) {
          @for (row of table.getRowModel().rows; track row.id) {
            <tr class="hover:bg-zinc-50">
              @for (cell of row.getVisibleCells(); track cell.id) {
                <td class="px-4 py-2 text-sm">
                  <ng-container
                    *flexRender="
                      cell.column.columnDef.cell;
                      props: cell.getContext();
                      let cell
                    "
                  >
                    <div [innerHTML]="cell"></div>
                  </ng-container>
                </td>
              }
            </tr>
          }
        } @else {
          <tr>
            <td
              [attr.colspan]="table.getFlatHeaders().length"
              class="h-24 text-center"
            >
              No results.
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <div class="mx-2 mt-4 flex items-center">
    <div class="flex-1">
      @if (table.getRowCount() > 0) {
        <p class="text-sm">
          Showing {{ entries().from }} to {{ entries().to }} of
          {{ entries().totalEntries }} entries.
        </p>
      }
    </div>

    <div class="flex items-center gap-8">
      <div>
        <p class="text-sm">
          Page {{ page() }} of
          {{ pagination()?.totalPages }}
        </p>
      </div>

      <div class="flex items-center gap-2">
        <button
          appButton
          variant="outline"
          size="icon"
          (click)="firstPage()"
          [disabled]="!hasPreviousPage()"
        >
          <span class="sr-only">First page</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            fill="currentColor"
            viewBox="0 0 16 16"
            class="size-3"
          >
            <path
              fill-rule="evenodd"
              d="M8.354 1.646a.5.5 0 0 1 0 .708L2.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"
            />
            <path
              fill-rule="evenodd"
              d="M12.354 1.646a.5.5 0 0 1 0 .708L6.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"
            />
          </svg>
        </button>
        <button
          appButton
          variant="outline"
          size="icon"
          (click)="previousPage()"
          [disabled]="!hasPreviousPage()"
        >
          <span class="sr-only">Previous page</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            fill="currentColor"
            viewBox="0 0 16 16"
            class="size-3"
          >
            <path
              fill-rule="evenodd"
              d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"
            />
          </svg>
        </button>
        <button
          appButton
          variant="outline"
          size="icon"
          (click)="nextPage()"
          [disabled]="!hasNextPage()"
        >
          <span class="sr-only">Next page</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            fill="currentColor"
            viewBox="0 0 16 16"
            class="size-3"
          >
            <path
              fill-rule="evenodd"
              d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"
            />
          </svg>
        </button>
        <button
          appButton
          variant="outline"
          size="icon"
          (click)="lastPage()"
          [disabled]="!hasNextPage()"
        >
          <span class="sr-only">Last page</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            fill="currentColor"
            viewBox="0 0 16 16"
            class="size-3"
          >
            <path
              fill-rule="evenodd"
              d="M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708"
            />
            <path
              fill-rule="evenodd"
              d="M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708"
            />
          </svg>
        </button>
      </div>
    </div>
  </div>
</section>
